<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Water Submetering</title>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            color: #000;
            text-align: center;
        }

        h2 {
            font-size: 30px;
            color: #0099ff;
        }

        p, label {
            font-size: 18px;
            color: #000;
        }

        select, input {
            padding: 8px;
            font-size: 16px;
            border-radius: 5px;
            border: 1px solid #ccc;
        }

        .container {
            background: rgb(255, 255, 255);
            padding: 20px;
            border-radius: 10px;
            display: inline-block;
            text-align: left;
            max-width: 400px;
            width: 100%;
            margin: 10px;
        }

        button {
            padding: 10px 20px;
            font-size: 16px;
            font-weight: bold;
            border: none;
            border-radius: 5px;
            margin: 10px;
            cursor: pointer;
            transition: 0.3s;
        }

        .btn-air {
            background-color: #dcdcdc;
            color: #444;
        }

        .btn-air:hover {
            background-color: #f0f0f0;
        }
    </style>
</head>
<body>
    <div id="readings">
        <div class="container">
            <h2>Water Submetering System</h2>
            <label for="waterType">Select Program:</label>
            <select class="waterType" onchange="calculate(this)">
                <option value="Cold">Cold</option>
                <option value="Hot">Hot</option>
                <option value="Warm">Warm</option>
            </select>
            <p><strong>Start Reading (m³):</strong><input type="number" class="start_read" required oninput="calculate(this)"></p>
            <p><strong>End Reading (m³):</strong><input type="number" class="endReading" required oninput="calculate(this)"></p>
            <p><strong>Cost per m³:</strong><input type="number" class="totalCost" required oninput="calculate(this)"></p>
            <p><strong>Total Used:</strong> <span class="totalUsed">0</span> m³</p>
            <p><strong>Total Cost(₱):</strong> <span class="cost">₱0</span></p>
        </div>
    </div>

    <button class="btn-air" onclick="addProgram()">Add Another Reading</button>
    <button class="btn-air" onclick="submitData()">Submit Data</button>

    <script>
    function calculate(element) {
        let container = element.closest(".container");
        let startRead = parseFloat(container.querySelector(".start_read").value) || 0;
        let endRead = parseFloat(container.querySelector(".endReading").value) || 0;
        let totalCost = parseFloat(container.querySelector(".totalCost").value) || 0;
        let totalUsed = endRead - startRead;
        let cost = totalUsed * totalCost;

        container.querySelector(".totalUsed").textContent = totalUsed;
        container.querySelector(".cost").textContent = "₱" + cost;
    }

    function addProgram() {
        let newDiv = document.createElement("div");
        newDiv.className = "container";
        newDiv.innerHTML = `
            <h2>Water Submetering System</h2>
            <label for="waterType">Select Program:</label>
            <select class="waterType" onchange="calculate(this)">
                <option value="Cold">Cold</option>
                <option value="Hot">Hot</option>
                <option value="Warm">Warm</option>
            </select>
            <p><strong>Start Reading (m³):</strong><input type="number" class="start_read" required oninput="calculate(this)"></p>
            <p><strong>End Reading (m³):</strong><input type="number" class="endReading" required oninput="calculate(this)"></p>
            <p><strong>Cost per m³:</strong><input type="number" class="totalCost" required oninput="calculate(this)"></p>
            <p><strong>Total Used:</strong> <span class="totalUsed">0</span> m³</p>
            <p><strong>Total Cost(₱):</strong> <span class="cost">₱0</span></p>
        `;
        document.getElementById("readings").appendChild(newDiv);
    }

    function submitData() {
    let readings = [];
    document.querySelectorAll(".container").forEach(container => {
        let waterType = container.querySelector(".waterType").value;
        let startRead = container.querySelector(".start_read").value;
        let endRead = container.querySelector(".endReading").value;
        let totalUsed = container.querySelector(".totalUsed").textContent;
        let cost = container.querySelector(".cost").textContent;

        readings.push({ waterType, startRead, endRead, totalUsed, cost });
    });

    localStorage.setItem("readingsData", JSON.stringify(readings));
    alert("Data submitted successfully!");

// Redirect after 2 seconds
setTimeout(function() {
    window.open("output.html", "blank"); // Redirect to the output page
    location.reload(); // Reload the current page after submission
}, 1000);

let programs = JSON.parse(localStorage.getItem("programs")) || [];
    
    let newProgram = {
        date: localStorage.getItem("date") || "N/A",
        load_number: localStorage.getItem("load_number") || "N/A",
        trolley_number: localStorage.getItem("trolley_number") || "N/A",
        equipment: localStorage.getItem("equipment") || "N/A",
        set_time: localStorage.getItem("set_time") || "N/A",
        program: localStorage.getItem("program") || "N/A",
        linen_type: localStorage.getItem("linen-type") || "N/A",
        linen_sizes: localStorage.getItem("linen_sizes") || "N/A",
        quantity: localStorage.getItem("quantity") || "N/A",
        bfr_wash: localStorage.getItem("bfr_wash") || "N/A",
        aftr_wash: localStorage.getItem("aftr_wash") || "N/A",
        rmc_total: localStorage.getItem("rmc_total") || "N/A"
    };

    programs.push(newProgram);
    localStorage.setItem("programs", JSON.stringify(programs));

    alert("Program added! You can add another or submit.");
}
    </script>
</body>
</html>
